{"ast":null,"code":"import _toConsumableArray from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/darlington-chuks/Documents/game-engine/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\n\nvar _jsxFileName = \"/home/darlington-chuks/Documents/game-engine/src/game/graphics/renderer.js\",\n    _this3 = this;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { PureComponent } from \"react\";\nimport * as THREE from 'three';\nimport EffectComposer from \"./effect-composer\";\nimport RenderPass from \"./passes/render-pass\";\nimport _ from \"lodash\"; //-- https://medium.com/@colesayershapiro/using-three-js-in-react-6cb71e87bdf4\n//-- https://medium.com/@summerdeehan/a-beginners-guide-to-using-three-js-react-and-webgl-to-build-a-3d-application-with-interaction-5d7b2c7ca89a\n//-- https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL\n\nvar ThreeView = /*#__PURE__*/function (_PureComponent) {\n  _inherits(ThreeView, _PureComponent);\n\n  var _super = _createSuper(ThreeView);\n\n  function ThreeView() {\n    var _this;\n\n    _classCallCheck(this, ThreeView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.onResize = function () {\n      var container = _this.refs.container;\n      var width = container.clientWidth;\n      var height = container.clientHeight;\n      var dpr = window.devicePixelRatio;\n\n      _this.props.camera.resize(width, height, dpr);\n\n      _this.renderer.setPixelRatio(dpr);\n\n      _this.renderer.setSize(width, height);\n    };\n\n    return _this;\n  }\n\n  _createClass(ThreeView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var container = this.refs.container;\n      var width = container.clientWidth;\n      var height = container.clientHeight;\n      var dpr = window.devicePixelRatio;\n      this.props.camera.resize(width, height, dpr);\n      this.renderer = new THREE.WebGLRenderer({});\n      this.renderer.setPixelRatio(dpr);\n      this.renderer.setSize(width, height);\n      this.renderer.setClearColor(0x020202, 1.0);\n      this.composer = new EffectComposer(this.renderer);\n      var passes = [new RenderPass(this.props.scene, this.props.camera)].concat(_toConsumableArray(this.props.passes));\n      passes.forEach(function (p) {\n        return _this2.composer.addPass(p);\n      });\n      passes[passes.length - 1].renderToScreen = true;\n      window.addEventListener(\"resize\", this.onResize);\n      container.appendChild(this.renderer.domElement);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"resize\", this.onResize);\n      var container = this.refs.container;\n      container.removeChild(this.renderer.domElement);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.composer) {\n        this.composer.render();\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        ref: \"container\",\n        style: css.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return ThreeView;\n}(PureComponent);\n\nvar css = {\n  container: {\n    height: \"100vh\",\n    width: \"100vw\",\n    overflow: \"hidden\"\n  }\n};\n\nvar renderHUD = function renderHUD(entities, window) {\n  if (!entities.hud) return null;\n  var hud = entities.hud;\n  if (typeof hud.renderer === \"object\") return /*#__PURE__*/React.createElement(hud.renderer.type, Object.assign({\n    key: \"hud\"\n  }, hud, {\n    window: window,\n    __self: _this3,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 12\n    }\n  }));else if (typeof hud.renderer === \"function\") return /*#__PURE__*/React.createElement(hud.renderer, Object.assign({\n    key: \"hud\"\n  }, hud, {\n    window: window,\n    __self: _this3,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 12\n    }\n  }));\n};\n\nvar ThreeJSRenderer = function ThreeJSRenderer() {\n  for (var _len2 = arguments.length, passes = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    passes[_key2] = arguments[_key2];\n  }\n\n  return function (entities, window) {\n    if (!entities) return null;\n    return [/*#__PURE__*/React.createElement(ThreeView, {\n      passes: _.flatten(passes),\n      key: \"threeView\",\n      scene: entities.scene,\n      camera: entities.camera,\n      __self: _this3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 5\n      }\n    }), renderHUD(entities, window)];\n  };\n};\n\nexport default ThreeJSRenderer;","map":{"version":3,"sources":["/home/darlington-chuks/Documents/game-engine/src/game/graphics/renderer.js"],"names":["React","PureComponent","THREE","EffectComposer","RenderPass","_","ThreeView","onResize","container","refs","width","clientWidth","height","clientHeight","dpr","window","devicePixelRatio","props","camera","resize","renderer","setPixelRatio","setSize","WebGLRenderer","setClearColor","composer","passes","scene","forEach","p","addPass","length","renderToScreen","addEventListener","appendChild","domElement","removeEventListener","removeChild","render","css","overflow","renderHUD","entities","hud","ThreeJSRenderer","flatten"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\nimport * as THREE from 'three';\nimport EffectComposer  from \"./effect-composer\";\nimport RenderPass from \"./passes/render-pass\";\nimport _ from \"lodash\";\n\n//-- https://medium.com/@colesayershapiro/using-three-js-in-react-6cb71e87bdf4\n//-- https://medium.com/@summerdeehan/a-beginners-guide-to-using-three-js-react-and-webgl-to-build-a-3d-application-with-interaction-5d7b2c7ca89a\n//-- https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL\n\nclass ThreeView extends PureComponent {\n\n  componentDidMount() {\n    const container = this.refs.container;\n    const width = container.clientWidth;\n    const height = container.clientHeight;\n    const dpr = window.devicePixelRatio;\n\n    this.props.camera.resize(width, height, dpr);\n    this.renderer = new THREE.WebGLRenderer({ });\n    this.renderer.setPixelRatio(dpr);\n    this.renderer.setSize(width, height);\n    this.renderer.setClearColor(0x020202, 1.0);\n    this.composer = new EffectComposer(this.renderer);\n\n    const passes = [\n      new RenderPass(this.props.scene, this.props.camera),\n      ...this.props.passes\n    ]\n\n    passes.forEach(p => this.composer.addPass(p))\n    passes[passes.length-1].renderToScreen = true;\n\n    window.addEventListener(\"resize\", this.onResize);\n\n    container.appendChild(this.renderer.domElement)\n  }\n  \n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.onResize);\n\n    const container = this.refs.container;\n    container.removeChild(this.renderer.domElement)\n  }\n\n  onResize = () => {\n    const container = this.refs.container;\n    const width = container.clientWidth;\n    const height = container.clientHeight;\n    const dpr = window.devicePixelRatio;\n\n    this.props.camera.resize(width, height, dpr);\n    this.renderer.setPixelRatio(dpr);\n    this.renderer.setSize(width, height);\n  };\n\n  render() {\n    if (this.composer) {\n      this.composer.render();\n    } \n\n    return (\n      <div ref={\"container\"} style={css.container} />\n    );\n  }\n}\n\nconst css = {\n  container: {\n    height: \"100vh\", \n    width: \"100vw\",\n    overflow: \"hidden\"\n  }\n}\n\nconst renderHUD = (entities, window) => {\n  if (!entities.hud) return null;\n\n  const hud = entities.hud;\n\n  if (typeof hud.renderer === \"object\")\n    return <hud.renderer.type key={\"hud\"} {...hud} window={window} />;\n  else if (typeof hud.renderer === \"function\")\n    return <hud.renderer key={\"hud\"} {...hud} window={window} />;\n};\n\nconst ThreeJSRenderer = (...passes) => (entities, window) => {\n  if (!entities) return null;\n  return [\n    <ThreeView\n      passes={_.flatten(passes)}\n      key={\"threeView\"}\n      scene={entities.scene}\n      camera={entities.camera}\n    />,\n    renderHUD(entities, window)\n  ];\n};\n\nexport default ThreeJSRenderer;\n"]},"metadata":{},"sourceType":"module"}