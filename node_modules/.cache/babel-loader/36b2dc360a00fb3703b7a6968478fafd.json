{"ast":null,"code":"import _ from \"lodash\";\nimport { interpolate } from '@popmotion/popcorn';\nimport * as ThreeUtils from \"./three\";\n\nvar remove = function remove(entities, key) {\n  var entity = entities[key];\n  if (!entity) return;\n  if (entity.model) ThreeUtils.remove(entity.model.parent, entity.model);\n  if (entity.light) ThreeUtils.remove(entity.light.parent, entity.light);\n\n  if (entity.particles) {\n    Object.keys(entity.particles).forEach(function (k) {\n      var emitter = entity.particles[k].emitter;\n      if (emitter) ThreeUtils.remove(emitter.parent, emitter);\n    });\n  }\n\n  if (entity.bodies) entity.bodies.forEach(function (b) {\n    return b.remove();\n  });\n  delete entities[key];\n  return entities;\n};\n\nvar any = function any() {\n  var arr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var b = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n  var c = arguments.length > 2 ? arguments[2] : undefined;\n\n  if (c) {\n    if (Array.isArray(c) === false) c = [c];\n    return _.isFunction(b) ? _.intersection(arr.map(b), c).length > 0 : _.intersection(arr.map(function (x) {\n      return x[b];\n    }), c).length > 0;\n  }\n\n  if (!b) return arr.length > 0;\n  if (Array.isArray(b)) return _.intersection(arr, b).length > 0;\n  if (_.isFunction(b)) return arr.find(b);\n  return arr.indexOf(b) > -1;\n};\n\nvar first = function first(entities) {\n  for (var _len = arguments.length, predicates = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    predicates[_key - 1] = arguments[_key];\n  }\n\n  if (!entities) return;\n  if (!predicates || predicates.length < 1) return entities[0];\n  if (Array.isArray(entities)) return entities.find(function (e) {\n    return _.every(predicates, function (p) {\n      return p(e);\n    });\n  });\n  return entities[Object.keys(entities).find(function (key) {\n    return _.every(predicates, function (p) {\n      return p(entities[key]);\n    });\n  })];\n};\n\nvar firstKey = function firstKey(entities) {\n  for (var _len2 = arguments.length, predicates = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    predicates[_key2 - 1] = arguments[_key2];\n  }\n\n  if (!entities) return;\n  if (!predicates || predicates.length < 1) return Object.keys(entities)[0];\n  return Object.keys(entities).find(function (key) {\n    return _.every(predicates, function (p) {\n      return p(entities[key]);\n    });\n  });\n};\n\nvar all = function all(entities) {\n  for (var _len3 = arguments.length, predicates = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    predicates[_key3 - 1] = arguments[_key3];\n  }\n\n  if (!entities) return;\n  if (!predicates || predicates.length < 1) return entities;\n  if (Array.isArray(entities)) return entities.filter(function (e) {\n    return _.every(predicates, function (p) {\n      return p(e);\n    });\n  });\n  return Object.keys(entities).filter(function (key) {\n    return _.every(predicates, function (p) {\n      return p(entities[key]);\n    });\n  }).map(function (key) {\n    return entities[key];\n  });\n};\n\nvar allKeys = function allKeys(entities) {\n  for (var _len4 = arguments.length, predicates = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    predicates[_key4 - 1] = arguments[_key4];\n  }\n\n  if (!entities) return;\n  if (!predicates || predicates.length < 1) return Object.keys(entities);\n  return Object.keys(entities).filter(function (key) {\n    return _.every(predicates, function (p) {\n      return p(entities[key]);\n    });\n  });\n}; //-- https://stackoverflow.com/a/7616484/138392\n\n\nvar getHashCode = function getHashCode(str) {\n  var hash = 0,\n      i,\n      chr;\n  if (str.length === 0) return hash;\n\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i);\n    hash = (hash << 5) - hash + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return hash;\n};\n\nvar positive = function positive(val) {\n  return Math.abs(val);\n};\n\nvar negative = function negative(val) {\n  if (val > 0) return -val;\n  return val;\n};\n\nvar remap = function remap(n, start1, stop1, start2, stop2) {\n  return (n - start1) / (stop1 - start1) * (stop2 - start2) + start2;\n};\n\nvar constrain = function constrain(n, low, high) {\n  return Math.max(Math.min(n, high), low);\n};\n\nvar between = function between(n, low, high) {\n  return n > low && n < high;\n};\n\nvar pipe = function pipe() {\n  for (var _len5 = arguments.length, funcs = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    funcs[_key5] = arguments[_key5];\n  }\n\n  return _.flow(_.flatten(funcs || []));\n};\n\nvar id = function id() {\n  var seed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return function () {\n    var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return \"\".concat(prefix).concat(++seed);\n  };\n};\n\nvar cond = function cond(condition, func) {\n  return function (args) {\n    var test = _.isFunction(condition) ? condition(args) : condition;\n    return test ? func(args) : args;\n  };\n};\n\nvar log = function log(label) {\n  return function (data) {\n    console.log(label, data);\n    return data;\n  };\n};\n\nvar randomInt = function randomInt() {\n  var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nvar throttle = function throttle(func, interval, defaultValue) {\n  var last = 0;\n  return function () {\n    var current = performance.now();\n\n    if (current - last > interval) {\n      last = current;\n      return func.apply(void 0, arguments);\n    } else {\n      return _.isFunction(defaultValue) ? defaultValue.apply(void 0, arguments) : defaultValue;\n    }\n  };\n};\n\nvar screen = window.screen;\n\nvar createSound = function createSound(asset) {\n  var throttleInterval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var audio = new Audio(asset);\n\n  var play = function play() {\n    return audio.play();\n  };\n\n  return throttleInterval ? throttle(play, throttleInterval) : play;\n};\n\nvar find = _.find;\nvar filter = _.filter;\nvar clamp = constrain;\nvar once = _.once;\nvar memoize = _.memoize;\nvar sound = createSound;\nexport { remove, any, find, filter, first, firstKey, all, allKeys, getHashCode, positive, negative, remap, constrain, clamp, between, pipe, id, cond, interpolate, log, randomInt, once, memoize, throttle, screen, createSound, sound };","map":{"version":3,"sources":["/home/darlington-chuks/Documents/game-engine/src/game/utils/index.js"],"names":["_","interpolate","ThreeUtils","remove","entities","key","entity","model","parent","light","particles","Object","keys","forEach","k","emitter","bodies","b","any","arr","c","Array","isArray","isFunction","intersection","map","length","x","find","indexOf","first","predicates","e","every","p","firstKey","all","filter","allKeys","getHashCode","str","hash","i","chr","charCodeAt","positive","val","Math","abs","negative","remap","n","start1","stop1","start2","stop2","constrain","low","high","max","min","between","pipe","funcs","flow","flatten","id","seed","prefix","cond","condition","func","args","test","log","label","data","console","randomInt","floor","random","throttle","interval","defaultValue","last","current","performance","now","screen","window","createSound","asset","throttleInterval","audio","Audio","play","clamp","once","memoize","sound"],"mappings":"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","sourcesContent":["import _ from \"lodash\";\nimport { interpolate } from '@popmotion/popcorn';\nimport * as ThreeUtils from \"./three\";\n\nconst remove = (entities, key) => {\n\tconst entity = entities[key];\n\n\tif (!entity) \n\t\treturn;\n\n\tif (entity.model)\n\t\tThreeUtils.remove(entity.model.parent, entity.model);\n\n\tif (entity.light)\n\t\tThreeUtils.remove(entity.light.parent, entity.light);\n\n\tif (entity.particles) {\n\t\tObject.keys(entity.particles).forEach(k => {\n\t\t\tconst emitter = entity.particles[k].emitter\n\t\t\tif (emitter)\n\t\t\t\tThreeUtils.remove(emitter.parent, emitter);\n\t\t})\n\t}\n\n\tif (entity.bodies)\n\t\tentity.bodies.forEach(b => b.remove())\n\n\tdelete entities[key];\n\n\treturn entities;\n};\n\nconst any = (arr = [], b = \"\", c) => {\n\tif (c) {\n\t\tif (Array.isArray(c) === false) c = [c];\n\n\t\treturn _.isFunction(b)\n\t\t\t? _.intersection(arr.map(b), c).length > 0\n\t\t\t: _.intersection(arr.map(x => x[b]), c).length > 0;\n\t}\n\n\tif (!b) return arr.length > 0;\n\n\tif (Array.isArray(b)) return _.intersection(arr, b).length > 0;\n\n\tif (_.isFunction(b)) return arr.find(b);\n\n\treturn arr.indexOf(b) > -1;\n};\n\nconst first = (entities, ...predicates) => {\n\tif (!entities) return;\n\tif (!predicates || predicates.length < 1) return entities[0];\n\n\tif (Array.isArray(entities))\n\t\treturn entities.find(e => _.every(predicates, p => p(e)))\n\n\treturn entities[Object.keys(entities).find(key => _.every(predicates, p => p(entities[key])))]\n}\n\nconst firstKey = (entities, ...predicates) => {\n\tif (!entities) return;\n\tif (!predicates || predicates.length < 1) return Object.keys(entities)[0];\n\n\treturn Object.keys(entities).find(key => _.every(predicates, p => p(entities[key])))\n}\n\nconst all = (entities, ...predicates) => {\n\tif (!entities) return;\n\tif (!predicates || predicates.length < 1) return entities;\n\n\tif (Array.isArray(entities))\n\t\treturn entities.filter(e => _.every(predicates, p => p(e)))\n\n\treturn Object.keys(entities).filter(key => _.every(predicates, p => p(entities[key]))).map(key => entities[key])\n}\n\nconst allKeys = (entities, ...predicates) => {\n\tif (!entities) return;\n\tif (!predicates || predicates.length < 1) return Object.keys(entities);\n\n\treturn Object.keys(entities).filter(key => _.every(predicates, p => p(entities[key])));\n}\n\n//-- https://stackoverflow.com/a/7616484/138392\nconst getHashCode = str => {\n  var hash = 0, i, chr;\n  if (str.length === 0) return hash;\n  for (i = 0; i < str.length; i++) {\n    chr   = str.charCodeAt(i);\n    hash  = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n};\n\nconst positive = val => Math.abs(val)\n\nconst negative = val => {\n\tif (val > 0) return -val\n\treturn val\n}\n\nconst remap = (n, start1, stop1, start2, stop2) => {\n  return (n - start1) / (stop1 - start1) * (stop2 - start2) + start2;\n}\n\nconst constrain = (n, low, high) => {\n  return Math.max(Math.min(n, high), low);\n}\n\nconst between = (n, low, high) => {\n  return n > low && n < high\n}\n\nconst pipe = (...funcs) => _.flow(_.flatten(funcs || []))\n\nconst id = (seed = 0) => (prefix = \"\") => `${prefix}${++seed}`\n\nconst cond = (condition, func) => {\n\treturn (args) => {\n\t\tconst test = _.isFunction(condition) ? condition(args) : condition\n\t\treturn test ? func(args) : args\n\t}\n}\n\nconst log = label => data => {\n\tconsole.log(label, data);\n\treturn data;\n}\n\nconst randomInt = (min = 0, max = 1) => Math.floor(Math.random() * (max - min + 1) + min);\n\nconst throttle = (func, interval, defaultValue) => {\n\tlet last = 0;\n\treturn (...args) => {\n\t\tconst current = performance.now();\n\t\tif ((current - last) > interval) {\n\t\t\tlast = current;\n\t\t\treturn func(...args);\n\t\t} else {\n\t\t\treturn _.isFunction(defaultValue) ? defaultValue(...args) : defaultValue;\n\t\t}\n\t}\n}\n\nconst screen = window.screen;\n\nconst createSound = (asset, throttleInterval = 0) => {\n\tconst audio = new Audio(asset);\n\tconst play = () => audio.play();\n\n\treturn throttleInterval ? throttle(play, throttleInterval) : play;\n};\n\nconst find = _.find;\nconst filter = _.filter;\nconst clamp = constrain;\nconst once = _.once;\nconst memoize = _.memoize;\nconst sound = createSound;\n\nexport {\n\tremove,\n\tany,\n\tfind,\n\tfilter,\n\tfirst,\n\tfirstKey,\n\tall,\n\tallKeys,\n\tgetHashCode,\n\tpositive,\n\tnegative,\n\tremap,\n\tconstrain,\n\tclamp,\n\tbetween,\n\tpipe,\n\tid,\n\tcond,\n\tinterpolate,\n\tlog, \n\trandomInt,\n\tonce,\n\tmemoize,\n\tthrottle,\n\tscreen,\n\tcreateSound,\n\tsound\n}"]},"metadata":{},"sourceType":"module"}